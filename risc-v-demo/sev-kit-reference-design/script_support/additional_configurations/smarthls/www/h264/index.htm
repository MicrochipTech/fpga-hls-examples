<html>
<head>
	<title>HLS Image Processing Demo</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="shortcut icon" type="image/x-icon" href="microchip.ico">
	<link rel="stylesheet" href="pfsoc.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<style>
.resolution {  
	border-color: RoyalBlue;
	padding: 7px 25px;  
	font-size: 13px;  
}  
/* set the position of dropdown */  
.dropdown {  
	     position: relative;  
	     display: inline-block;  
}  
/* set the size and position of button on web */  
.btn {
	background-color: DodgerBlue;
	border: none;
	color: white;
	padding: 8px 30px;
	cursor: pointer;
	font-size: 12px;
}

/* Darker background on mouse-over */
.btn:hover {
	background-color: RoyalBlue;
}
#wrapper {
	margin-left:auto;
	margin-right:auto;
	width:1220px;
}
</style>
</head>
<script>  
	//show and hide dropdown list item on button click  
	function show_hide() {  
		var click = document.getElementById("list-items");  
		if(click.style.display ==="none") {  
		click.style.display ="block";  
		} else {  
		click.style.display ="none";  
		}   
	}  
</script>  
<div id="wrapper">

<body>
	<!-- 	<img src="mchp_logo1.png" alt="Microchip" width="240" height="56"></br>
	<img src="microchip_logo.png" alt="Microchip" width="200" height="100"></br> -->
	<img src="mchp_logo2.png" alt="Microchip" width="187" height="100"></br>
<table width=100% align=center >
	<tr height=5px> 	</tr>
	<tr><td>
	<img src="header_h264.png" alt="Microchip" width="100%" height="45"></br>
	</td> </tr>
	<tr height=25px> 	</tr>
</table>
<table width=75% align=center >
	<tr><p id=fpsId style="font-family:verdana;font-size:16px; font-weight:bold;">FPS:</p></tr>
	<tr height=25px align=right> 
		<td >
			<form action="update.php">
			<div class="dropdown">
			<div style="color:blue;font-family:verdana;font-size:13px;">
			<b>Data Path:</b>
			<select class="datapath" id="s_datapath" name="datapath"
				style="color:blue;font-family:verdana;font-size:13px; font-weight:bold;">
				<option value="1"> CPU </option>
				<option value="2" selected> FPGA </option>
			</select>  
		</td>
	</tr>
	<!-- <tr height=25px align=right> 
		<td >
			<form action="update.php">
			<div class="dropdown">
			<div style="color:blue;font-family:verdana;font-size:13px;">
			<b>Resolution:</b>
			<select class="resolution" id = "s_resolution" name="resolution"
				style="color:blue;font-family:verdana;font-size:13px; font-weight:bold;">
				<option value="1"> 432x240 </option>  
				<option value="2"> 640x480 </option>  
				<option value="3"> 960x544 </option>  
				<option value="4" selected> 1280x720 </option>  
				<option value="5"> 1920x1072 </option>  
			</select>  
		</td>
	</tr> -->
</table>

<table width=75% align=center bordercolor="#00008B">
	<tr>
		<td width=35% align=center>
			<p style="color:blue;font-family:verdana;font-size:16px" 
			align=left>&nbsp;&nbsp;Brightness:</p>
		</td>
		<td style="width:5%" align=left> </td>
		<td style="width:2%" align=left> </td>
		
		<td style="width:8%" align=left> </td>
		<td width=35% align=center>
			<p style="color:blue;font-family:verdana;font-size:16px" 
			align=left>&nbsp;&nbsp;Color Balance: Red</p>
		</td>
		<td style="width:5%" align=left> </td>
		<td style="width:2%" align=left> </td>
		<td style="width:8%" align=left> </td>
	</tr>
	<tr>
		<td width=35% align=center>
			<input type="range" min="1" max="255" name="brightness" value="137" 
			class="slider" id="s_bright" step="1"> 
		</td>
	        <td style="width:5%" align=left> 
			<input style="width:50px;color:blue;font-family:verdana;
			font-size:12px;	font-weight: bold;" 
			type="text" id="v_bright" name="t_bright" value="137" disabled>
		</td>
		<td style="width:2%" align=center>
			<div> <img id="reset1" src="reset.png" alt="Reset" onclick="func_a();"
			style="width:20px;height:20px;" title="Reset" /> </div>
		</td>
	        <td style="width:8%" align=left> </td>
		
		<td width=35% align=center>
			<input type="range" min="1" max="255" name="cbred" value="122" 
			class="slider" id="s_red" step="1"> 
		</td>
	        <td style="width:5%" align=left> 
			<input style="width:50px;color:blue;font-family:verdana;
			font-size:12px;	font-weight: bold;" 
			type="text" id="v_red" name="t_red" value="122" disabled>
		</td>
		<td style="width:2%" align=center>
			<div> <img id="reset2" src="reset.png" alt="Reset" onclick="func_b();"
			style="width:20px;height:20px;" title="Reset" /> </div>
		</td>
	        <td style="width:8%" align=left> </td>
	</tr>
	<tr>
		<td width=35% align=center>
			<p style="color:blue;font-family:verdana;font-size:16px" 
			align=left>&nbsp;&nbsp;Contrast:</p>
		</td>
	        <td style="width:5%" align=left> 
		</td>
	        <td style="width:2%" align=left> </td>
	        <td style="width:8%" align=left> </td>
		<td width=35% align=center>
			<p style="color:blue;font-family:verdana;font-size:16px" 
			align=left>&nbsp;&nbsp;Color Balance: Green</p>
		</td>
	        <td style="width:5%" align=left> 
		</td>
	        <td style="width:2%" align=left> </td>
	        <td style="width:8%" align=left> </td>
	</tr>
	<tr>
		<td width=35% align=center>
			<input type="range" min="1" max="255" name="contrast" value="154" 
			class="slider" id="s_contrast" step="1"> 
		</td>
	        <td style="width:5%" align=left> 
			<input style="width:50px;color:blue;font-family:verdana;
			font-size:12px;	font-weight: bold;" 
			type="text" id="v_contrast" name="t_contrast" value="154" disabled>
		</td>
		<td style="width:2%" align=center>
			<div> <img id="reset3" src="reset.png" alt="Reset" onclick="func_c();"
			style="width:20px;height:20px;" title="Reset" /> </div>
		</td>
	        <td style="width:8%" align=left> </td>
		
		<td width=35% align=center>
			<input type="range" min="1" max="255" name="cbgreen" value="102" 
			class="slider" id="s_green" step="1"> 
		</td>
	        <td style="width:5%" align=left> 
			<input style="width:50px;color:blue;font-family:verdana;
			font-size:12px;	font-weight: bold;" 
			type="text" id="v_green" name="t_green" value="102" disabled>
		</td>
		<td style="width:2%" align=center>
			<div> <img id="reset4" src="reset.png" alt="Reset" onclick="func_d();"
			style="width:20px;height:20px;" title="Reset" /> </div>
		</td>
	        <td style="width:8%" align=left> </td>
	</tr>
	<tr>
		<td width=35% align=center>
			<p style="color:blue;font-family:verdana;font-size:16px" 
			align=left>&nbsp;&nbsp;Quality Factor:</p>
		</td>
	        <td style="width:5%" align=left> 
		</td>
	        <td style="width:2%" align=left> </td>
	        <td style="width:8%" align=left> </td>

		<td width=35% align=center>
			<p style="color:blue;font-family:verdana;font-size:16px" 
			align=left>&nbsp;&nbsp;Color Balance: Blue</p>
		</td>
	        <td style="width:5%" align=left> 
		</td>
	        <td style="width:2%" align=left> </td>
	        <td style="width:8%" align=left> </td>
	</tr>
	<tr>
		<td width=35% align=center>
			<input type="range" min="25" max="51" name="qf" value="30" 
			class="slider" id="s_qf" step="1"> 
		</td>
	        <td style="width:5%" align=left> 
			<input style="width:50px;color:blue;font-family:verdana;
			font-size:12px;	font-weight: bold;" 
			type="text" id="v_qf" name="t_qf" value="30" disabled>
		</td>
		<td style="width:2%" align=center>
			<div> <img id="reset5" src="reset.png" alt="Reset" onclick="func_e();"
			style="width:20px;height:20px;" title="Reset" /> </div>
		</td>
	        <td style="width:8%" align=left> </td>

		<td width=35% align=center>
			<input type="range" min="1" max="255" name="cbblue" value="138" 
			class="slider" id="s_blue" step="1"> 
		</td>
	        <td style="width:5%" align=left> 
			<input style="width:50px;color:blue;font-family:verdana;
			font-size:12px;	font-weight: bold;" 
			type="text" id="v_blue" name="t_blue" value="138" disabled>
		</td>
		<td style="width:2%" align=center>
			<div> <img id="reset6" src="reset.png" alt="Reset" onclick="func_f();"
			style="width:20px;height:20px;" title="Reset" /> </div>
		</td>
	        <td style="width:8%" align=left> </td>
	</tr>

	<tr height=25px></tr>
</table>
<table width=75% align=center bordercolor="#00008B">
	<tr>
		<td width=35% align=center>
			<p style="color:blue;font-family:verdana;font-size:16px" align=left>&nbsp;&nbsp;Threshold to zero:</p>
		</td>
	</tr>
	<tr>
		<td width=35% align=center>
			<input type="range" min="0" max="255" name="thresh" value="0" 
			class="slider" id="s_thresh" step="1">
		</td>
	    <td style="width:5%" align=left> 
			<input style="width:50px;color:blue;font-family:verdana;
			font-size:12px;	font-weight: bold;" 
			type="text" id="v_thresh" name="t_thresh" value="0" disabled>
		</td>
		<td style="width:2%" align=center>
			<div> <img id="reset7" src="reset.png" alt="Reset" onclick="func_g();"
			style="width:20px;height:20px;" title="Reset" /> </div>
		</td>
	</tr>
	<tr>
		<td style="color:blue;font-family:verdana;font-size:16px" width=25% align=left>
			<input type="checkbox" name="invert" id="c_invert"><label for="invert">Invert</label>
		</td>
		<td style="color:blue;font-family:verdana;font-size:16px" width=25% align=left>
			<input type="checkbox" name="sobel" id="c_sobel"><label for="sobel">Sobel</label>
		</td>
		<td style="color:blue;font-family:verdana;font-size:16px" width=25% align=left>
			<input type="checkbox" name="watermark" id="c_watermark"> <label for="watermark">Watermark</label>
		</td>
		<td style="color:blue;font-family:verdana;font-size:16px" width=25% align=left>
			<input type="checkbox" name="rotozoom" id="c_rotozoom"> <label for="rotozoom">Rotozoom</label>
		</td>
	</tr>
</table>
 <table align=center width=30%>
	<tr height=20px></tr>
	<tr align=center>
	    <td style="width:25%" align=center> 
			<button type="submit" align=center id=update> Update </button>
		</td>
	</form>
	        <td style="width:25%" align=center> </td>
	        <td style="width:25%" align=center> 
				<input type="button" value="Start Video" id="start" />
			</td>
	        <td style="width:25%" align=center> 
				<input type="button" value="Stop Video" id="stop" />
			</td>
	</tr>
	<tr height=20px>
	</tr>
</table>
<!-- <table align=center width=75%>
	<tr height=60px>
		<td style="width:25%" align=center> 
			<input type="button" value="rotozoom" id="rotozoom" />
		</td>
		<td style="width:25%" align=center> 
			<input type="button" value="invert" id="invert" />
		</td>
	</tr>
</table> -->
<table align=center width=75%>
	<tr height=20px>
	<td style="width:30%" align=center>  	</td>
	<td style="width:20%" align=right> 
	<a href="video.sdp" download button class="btn">
		<i class="fa fa-download"></i> SDP file</button>
	</td>
	</tr>
</table>

<table width=100% align=center >
	<tr height=10px></tr>
	<tr><td>
	<img src="footer_h264.png" alt="Microchip" width="100%" height="150" 
	usemap="#image-map"></br>
	<!-- Image Map Generated by http://www.image-map.net/ -->
	<map name="image-map">
	<area target=_blank" alt="Microchip Technology Inc.- Facebook" title="Microchip Technology Inc.- Facebook" href="https://www.facebook.com/pages/Microchip-Technology-Inc/20320981741" coords="500,10,525,40" shape="rect">
	<area target=_blank" alt="Microchip Technology Inc.- LinkedIn" title="Microchip Technology Inc.- LinkedIn" href="https://www.linkedin.com/company/microchip-technology" coords="530,10,555,40" shape="rect">
	<area target=_blank" alt="MicrochipTech @MicrochipTech - Twitter" title="MicrochipTech @MicrochipTech - Twitter" href="https://twitter.com/MicrochipTech" coords="560,10,585,40" shape="rect">
	<area target=_blank" alt="Microchip Technology - YouTube" title="Microchip Technology - YouTube" href="https://www.youtube.com/user/MicrochipTechnology" coords="590,10,615,40" shape="rect">
	<area target=_blank" alt="Microchip Technology Inc (@microchiptechnologyinc)" title="Microchip Technology Inc (@microchiptechnologyinc)" href="https://www.instagram.com/microchiptechnologyinc/" coords="620,10,645,40" shape="rect">
	<area target=_blank" alt="www.weibo.com" title="www.weibo.com" href="https://www.weibo.com/microchiptech" coords="650,10,675,40" shape="rect">
	<area target=_blank" alt="MicroSolutions | Microchip Technology" title="MicroSolutions | Microchip Technology" href="https://www.microchip.com/en-us/about/" coords="680,10,705,40" shape="rect">
	<area target=_blank" alt="Contact Us | Microchip Technology " title="Contact Us | Microchip Technology " href="https://www.microchip.com/about-us/contact-us" coords="393,50,460,65" shape="rect">
	<area target=_blank" alt="Legal Information | Microchip Technology " title="Legal Information | Microchip Technology " href="https://www.microchip.com/en-us/about/legal-information" coords="489,50,525,65" shape="rect">
	<area target=_blank" alt="Privacy Policy | Microchip Technology " title="Privacy Policy | Microchip Technology " href="https://www.microchip.com/en-us/about/legal-information/privacy-policy" coords="535,50,650,65" shape="rect">
	<area target=_blank" alt="Microchip Cookie Statement | Microchip Technology " title="Microchip Cookie Statement | Microchip Technology " href="https://www.microchip.com/en-us/about/legal-information/microchip-cookie-statement" coords="670,50,725,65" shape="rect">
	<area target=_blank" alt="Microchip Careers | Not just a company - a community" title="Microchip Careers | Not just a company - a community" href="https://careers.microchip.com/" coords="750,50,800,65" shape="rect">
	</map>
	</td></tr>
	<tr height=5px></tr>
</table>
        <script>
		function func_a() {
			document.getElementById('s_bright').value = 137;
			document.getElementById('v_bright').value = 137;
			}
		function func_b() {
			document.getElementById('s_red').value = 122;
			document.getElementById('v_red').value = 122;
			}
		function func_c() {
			document.getElementById('s_contrast').value = 154;
			document.getElementById('v_contrast').value = 154;
			}
		function func_d() {
			document.getElementById('s_green').value = 102;
			document.getElementById('v_green').value = 102;
			}
		function func_e() {
			document.getElementById('s_qf').value = 30;
			document.getElementById('v_qf').value = 30;
			}
		function func_f() {
			document.getElementById('s_blue').value = 138;
			document.getElementById('v_blue').value = 138;
			}
		function func_g() {
			document.getElementById('s_thresh').value = 0;
			document.getElementById('v_thresh').value = 0;
			}			
        </script>


	<script>
	var bright_slider = document.getElementById("s_bright");
	var bright_val = document.getElementById("v_bright");
	bright_val.innerHTML = bright_slider.value;
	bright_slider.oninput = function() {	 
		bright_val.innerHTML = this.value;	
                document.getElementById("v_bright").value = bright_slider.value; 
	}
	</script>
	<script>
	var red_slider = document.getElementById("s_red");
	var red_val = document.getElementById("v_red");
	red_val.innerHTML = red_slider.value;
	red_slider.oninput = function() {	 red_val.innerHTML = this.value;	
                document.getElementById("v_red").value = red_slider.value; 
	}
	</script>
	<script>
	var contrast_slider = document.getElementById("s_contrast");
	var contrast_val = document.getElementById("v_contrast");
	contrast_val.innerHTML = contrast_slider.value;
	contrast_slider.oninput = function() {	 contrast_val.innerHTML = this.value; 	
                document.getElementById("v_contrast").value = contrast_slider.value; 
	}
	</script>
	<script>
	var green_slider = document.getElementById("s_green");
	var green_val = document.getElementById("v_green");
	green_val.innerHTML = green_slider.value;
	green_slider.oninput = function() {	 green_val.innerHTML = this.value;	
                document.getElementById("v_green").value = green_slider.value; 
	}
	</script>
	<script>
	var qf_slider = document.getElementById("s_qf");
	var qf_val = document.getElementById("v_qf");
	qf_val.innerHTML = qf_slider.value;
	qf_slider.oninput = function() {	 
		qf_val.innerHTML = this.value; 	
                document.getElementById("v_qf").value = qf_slider.value; 
	}
	</script>
	<script>
	var blue_slider = document.getElementById("s_blue");
	var blue_val = document.getElementById("v_blue");
	blue_val.innerHTML = blue_slider.value;
	blue_slider.oninput = function() {	 
		blue_val.innerHTML = this.value;	
        document.getElementById("v_blue").value = blue_slider.value; 
	}
	</script>
	<script>
	var threshold_slider = document.getElementById("s_thresh");
	var threshold_value = document.getElementById("v_thresh");
	threshold_value.innerHTML = threshold_slider.value;
	threshold_slider.oninput = function() {	 
		threshold_value.innerHTML = this.value;	
        document.getElementById("v_thresh").value = threshold_slider.value; 
	}
	</script>

	<script>
	function reset() {
			  document.getElementById("v_bright").value = "128";
			  document.getElementById("v_contrast").value = "128";
			  document.getElementById("v_qf").value = "50";
			  document.getElementById("v_red").value = "128";
			  document.getElementById("v_green").value = "128";
			  document.getElementById("v_blue").value = "128";
	}
	</script>

	<script type="text/javascript">
		document.getElementById("stop").onclick = function () {
			location.href = "stop.php";
			// stopFPS();
		};
	</script>

	<script type="text/javascript">
		document.getElementById("start").onclick = function () {
			// startFPS();
			// "resolution=" + document.getElementById("s_resolution").value +
			location.href = "start.php?" +
				"resolution=4" +
				"&datapath=" + document.getElementById("s_datapath").value +
				"&thresh=" + document.getElementById("v_thresh").value +
				"&invert=" + (document.getElementById("c_invert").checked ? "on" : "off") +
				"&sobel=" + (document.getElementById("c_sobel").checked ? "on" : "off") +
				"&watermark=" + (document.getElementById("c_watermark").checked ? "on" : "off") +
				"&rotozoom=" + (document.getElementById("c_rotozoom").checked ? "on" : "off");
		};
	</script>

	<!-- <script>
		var invertCnt = 0;	
		document.getElementById("invert").onclick = function () {
			invertCnt = invertCnt + 1;
			document.getElementById("invert").value = "Invert:" + invertCnt;
		};
	</script> -->

	<!-- <script> -->
		 <!-- function change() 
		 {
		 	var elem = document.getElementById("start");
		 	if (elem.value=="Stop") {
		 		location.href='stop.php';
		 	}
		 	else {
		 		location.href='start.php';
		 	}
		 } -->
	<!--  </script> -->

	<!-- var invertState; -->
	<!-- <script>
		function loadFile() {
			var result = null;
			var xmlhttp = new XMLHttpRequest();
			xmlhttp.open("GET", "./newfile.txt", false);
			xmlhttp.send();
			if (xmlhttp.status==200) {
				result = xmlhttp.responseText;
			}
			if (invertState == "off")
				invertState = "on";
			else if (invertState == "on")
				invertState = "off";

			result = result + invertState;
			alert(result);
		}
	</script> -->
	<!-- <script type="text/javascript">
		document.getElementById("invert").onclick = function () {
			location.href = "invert.php";
		};
	</script>

	<script type="text/javascript">
		document.getElementById("rotozoom").onclick = function () {
			location.href = "rotozoom.php";
		};
	</script> -->

	<script>
		function getFPS() {
            var result = null;
            var xmlhttp = new XMLHttpRequest();
            xmlhttp.open("GET", "./fps.txt", false);
            xmlhttp.send();
            if (xmlhttp.status==200) {
               result = xmlhttp.responseText;
            }
            // alert(result);
            document.getElementById("fpsId").innerHTML = "FPS:" + result;
            // document.write(result);
        }

		// function startFPS() {
		var timerId = setInterval('getFPS();', 1000); //call test every 1 second.
		// }

        function stopFPS() { // call this to stop your interval.
        	clearInterval(timerId);
        }
	</script>

	<script>
		window.onload = function() {
			// getFPS();
			document.getElementById("start").disabled = false;
			document.getElementById("stop").disabled = true;
			document.getElementById("update").disabled = true;
			url = new URL(window.location.href);
			// let search_params = url.searchParams; 
			let status = url.searchParams.get('stream');
			if(status=="started") {
				document.getElementById("start").disabled = true;
				document.getElementById("stop").disabled = false;
				document.getElementById("update").disabled = false;
			}

			// url = new URL(window.location.href);

			var bright_slider = document.getElementById("s_bright");
			var bright_value = document.getElementById("v_bright");
			var contrast_slider = document.getElementById("s_contrast");
			var contrast_value = document.getElementById("v_contrast");
			var qf_slider = document.getElementById("s_qf");
			var qf_value = document.getElementById("v_qf");
			var red_slider = document.getElementById("s_red");
			var red_value = document.getElementById("v_red");
			var green_slider = document.getElementById("s_green");
			var green_value = document.getElementById("v_green");
			var blue_slider = document.getElementById("s_blue");
			var blue_value = document.getElementById("v_blue");
			var threshold_slider = document.getElementById("s_thresh");
			var threshold_value = document.getElementById("v_thresh");
			// var resolution_value = document.getElementById("s_resolution");
			var datapath_value = document.getElementById("s_datapath");
			var invert_value = document.getElementById("c_invert");
			var sobel_value = document.getElementById("c_sobel");
			var watermark_value = document.getElementById("c_watermark");
			var rotozoom_value = document.getElementById("c_rotozoom");

			

			if (url.searchParams.get('v_bright')) {
				bright_slider.value = getURIParameter("v_bright");
				bright_value.value = getURIParameter("v_bright");
				contrast_slider.value = getURIParameter("v_contrast");
				contrast_value.value = getURIParameter("v_contrast");
				qf_slider.value = getURIParameter("v_qf");
				qf_value.value = getURIParameter("v_qf");
				red_slider.value = getURIParameter("v_red");
				red_value.value = getURIParameter("v_red");
				green_slider.value = getURIParameter("v_green");
				green_value.value = getURIParameter("v_green");
				blue_slider.value = getURIParameter("v_blue");
				blue_value.value = getURIParameter("v_blue");
			}

			if (url.searchParams.get('v_datapath')) {
				threshold_slider.value = getURIParameter("v_thresh");
				threshold_value.value = getURIParameter("v_thresh");
				datapath_value.value = getURIParameter("v_datapath");
				// resolution_value.value = getURIParameter("v_resolution");
				invert_value.checked = (getURIParameter("v_invert") == "on") ? true : false;
				sobel_value.checked = (getURIParameter("v_sobel") == "on") ? true : false;
				watermark_value.checked = (getURIParameter("v_watermark") == "on") ? true : false;
				rotozoom_value.checked = (getURIParameter("v_rotozoom") == "on") ? true : false;
			}
		}
	</script>
	<script>
	function getURIParameter(param, asArray) {
	return document.location.search.substring(1).split('&').reduce(function(p,c) {
	var parts = c.split('=', 2).map(function(param) { return decodeURIComponent(param); });
	if(parts.length == 0 || parts[0] != param) return (p instanceof Array) && !asArray ? null : p;
	return asArray ? p.concat(parts.concat(true)[1]) : parts.concat(true)[1];
	}, []);
	}
	</script>

</div>
</body>
</html>
